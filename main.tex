\documentclass[12pt]{article}

% For document layout and formatting
\usepackage[a4paper, vmargin=2.54cm,
hmargin=2.54cm]{geometry}
\usepackage{etoolbox,lineno}
\linespread{1.1} % 1.6 for double spacing and 1.3 for one-and-a-half spacing
\usepackage[T1]{fontenc}
\usepackage{textcomp}
\usepackage[utf8]{inputenc}
\usepackage[english]{babel}
\usepackage{xr}
\usepackage{subfiles}
% \externaldocument{\subfix{main}}
\usepackage[titletoc,page]{appendix}
\usepackage[acronym]{glossaries}
\usepackage{csquotes}
\usepackage{xargs} % Use more than one optional parameter in a new commands

% For to-do lists
\setlength{\marginparwidth}{2cm}
\usepackage[colorinlistoftodos,
            prependcaption,
            textsize=tiny]
            {todonotes}
\usepackage{marginnote}
\renewcommand{\marginpar}{\marginnote}

\definecolor{OliveGreen}{RGB}{181,179,92}
\definecolor{Plum}{RGB}{142,69,133}
\definecolor{Goldenrod}{RGB}{245,198,60}

\newcommandx{\tobedone}[2][1=]{
    \todo[linecolor=red,
            backgroundcolor=red!25,
            bordercolor=red,#1]{#2}
}
\newcommandx{\unsure}[2][1=]{
    \todo[linecolor=Goldenrod,
            backgroundcolor=Goldenrod!25,
            bordercolor=Goldenrod,#1]{#2}
}
\newcommandx{\change}[2][1=]{
    \todo[linecolor=blue,
            backgroundcolor=blue!25,
            bordercolor=blue,#1]{#2}
}
\newcommandx{\info}[2][1=]{
    \todo[linecolor=OliveGreen,
            backgroundcolor=OliveGreen!25,
            bordercolor=OliveGreen,#1]{#2}
}
\newcommandx{\improvement}[2][1=]{
    \todo[linecolor=Plum,
            backgroundcolor=Plum!25,
            bordercolor=Plum,#1]{#2}
}
\newcommandx{\thiswillnotshow}[2][1=]{
    \todo[disable,#1]{#2}
}

% For fonts and symbols
\usepackage{times}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{amsthm}
\usepackage{amsfonts}
\usepackage{xspace}
\usepackage{siunitx}
\sisetup{
    mode=text,
    per-mode=symbol,
    product-units=single,
    range-units=single,
    group-separator={,},
}

% For references
\usepackage[backend=biber, style=ieee]{biblatex}
\addbibresource{refs.bib}
\usepackage{hyperref}
\hypersetup{
    colorlinks,
    citecolor=black,
    filecolor=black,
    linkcolor=black,
    urlcolor=black
}
\usepackage[capitalise, nameinlink, nosort]{cleveref} % [capitalise,noabbrev] options
\crefname{figure}{Fig.}{Fig.}
\crefname{table}{Table}{Table}

% For equations
\usepackage{extramarks}
\usepackage{float}
\usepackage{cancel} % to use diagonal strikethrough to zero
\usepackage{physics} % to use absolute and norm (for vectors) symbols
\usepackage{array}
\usepackage{tabularx}
\usepackage{calc}
\usepackage{microtype}
\usepackage[plain]{algorithm}
\usepackage{algpseudocode}
\usepackage[most]{tcolorbox}

\newtcolorbox{newrequirements}{%
    title={\textsf{New requirements}},
    colframe=red!75!black,
    colback=red!5!white,
    fonttitle=\bfseries,
    breakable,
    enhanced,
    toptitle=2mm,
}

% For plotting
\usepackage{pgfplots}
\usepackage{pgfplotstable}
% \pgfplotstabletypeset{search path={tables}}
\pgfplotsset{
    compat=newest,
    % ignore zero/.style={%
    %     #1ticklabel={\ifdim\tick pt=0pt 0 \else\pgfmathprintnumber{\tick}\fi}
    %     },
    yticklabel={\ifdim\tick pt=0pt 0 \else\pgfmathprintnumber{\tick}\fi},
    table/search path={tables,graphs},
} % Allows to place the legend below plot
\usepgfplotslibrary{units} % Allows to enter the units nicely

% For figures
\usepackage{graphicx}
\graphicspath{ {./images/} }
\usepackage{wrapfig}
\usepackage{subfig}
\usepackage{tikz}
\usetikzlibrary{automata,positioning,calc,fit,matrix}

% For tables
\usepackage{afterpage, longtable}
\usepackage{xltabular}
\usepackage{booktabs}
\usepackage{multirow}
\usepackage{diagbox}
\usepackage{makecell}
\usepackage{caption}
\DeclareCaptionLabelSeparator{ieee}{.\quad}
\captionsetup[table]{
    skip=5pt,
    labelsep=ieee,
}
\captionsetup[figure]{
    name=Fig.,
    labelsep=ieee,
}

% For better lists
\usepackage{enumerate}
\usepackage{enumitem}

% For dummy text
\usepackage{blindtext}
\usepackage{lipsum}

\addto\captionsenglish{%
  \renewcommand{\contentsname}%
    {Table of Contents}%
}

%%% Checklist
\newlist{todolist}{itemize}{2}
\setlist[todolist]{label=$\square$}
\usepackage{pifont}
\newcommand{\cmark}{\ding{51}}%
\newcommand{\xmark}{\ding{55}}%
\newcommand{\done}{\rlap{$\square$}{\raisebox{2pt}{\large\hspace{1pt}\cmark}}%
\hspace{-2.5pt}}
\newcommand{\wontfix}{\rlap{$\square$}{\large\hspace{1pt}\xmark}}

%%% Appendix title name
\renewcommand{\appendixtocname}{Appendix}
\renewcommand{\appendixpagename}{Appendix}
% \renewcommand{\appendixpagename}{\Large Appendix}

%%% Common shortcuts
\newcommand{\anafi}{\textsc{anafi}\xspace}
\newcommand{\gym}{the \textsc{o}pen\textsc{ai} 
    \textsc{g}ym\xspace} 
\newcommand{\id}{\textsc{id}\xspace} 
\newcommand{\uav}{\gls{uav}\xspace}
\newcommand{\Uav}{\Gls{uav}\xspace}
\newcommand{\uavs}{\glspl{uav}\xspace}
\newcommand{\Uavs}{\Glspl{uav}\xspace}
\newcommand{\cctv}{\gls{cctv}\xspace}
\newcommand{\cctvs}{\glspl{cctv}\xspace}
\newcommand{\csn}{\gls{csn}\xspace}
\newcommand{\csns}{\glspl{csn}\xspace}
\newcommand{\qar}[1]{\SI{#1}[\textsc{qar}\,]\xspace}

%%% List of abbreviations
%%% note: do not capitalize unless it is a proper noun
%%%       and use the \textsc command as a best practice

% Machine learning
\newacronym{ml}{\textsc{ml}}{machine learning}
\newacronym{ai}{\textsc{ai}}{artificial intelligence}
\newacronym{dl}{\textsc{dl}}{deep learning}
\newacronym{sl}{\textsc{sl}}{supervised learning}
\newacronym{rl}{\textsc{rl}}{reinforcement learning}
\newacronym{drl}{\textsc{drl}}{deep reinforcement learning}
\newacronym{dqn}{\textsc{dqn}}{Deep Q-Network}
\newacronym{mdp}{\textsc{mdp}}{Markov decision process}
\newacronym{pomdp}{\textsc{pomdp}}{partially observable Markov decision process}
\newacronym{cnn}{\textsc{cnn}}{convolutional neural network}
\newacronym{ppo}{\textsc{ppo}}{Proximal Policy Optimization}
\newacronym{trpo}{\textsc{trpo}}{Trust Region Policy Optimization}
\newacronym{gae}{\textsc{gae}}{Generalized Advantage Estimate}
\newacronym{a2c}{\textsc{a2c}}{Advantage Actor Critic}
\newacronym{iid}{\textsc{iid}}{independent and identically distributed}

% Simulation
\newacronym{sitl}{\textsc{sitl}}{software-in-the-loop}
\newacronym{uav}{\textsc{uav}}{unmanned aerial vehicle}
\newacronym{ros}{\textsc{ros}}{the Robot Operating System}

% Institutions
\newacronym{ieee}{\textsc{ieee}}{the Institute of Electrical and Electronics Engineers}
\newacronym{acm}{\textsc{acm}}{the Association for Computing Machinery}

% Technologies
\newacronym{gps}{\textsc{gps}}{the Global Positioning System}
\newacronym{lidar}{\textsc{lidar}}{Light Detection and Ranging}
\newacronym{fov}{\textsc{fov}}{field of view}
\newacronym{sdf}{\textsc{sdf}}{Simulation Description Format}
\newacronym{cctv}{\textsc{cctv}}{closed-circuit television}
\newacronym{csn}{\textsc{csn}}{camera sensor network}
\newacronym{rc}{\textsc{r/c}}{remotely controlled}
% never expand the these acronyms
\glsunset{ieee}
\glsunset{acm}
\glsunset{gps}
\glsunset{lidar}

\let\linenumbers\nolinenumbers\nolinenumbers

\begin{document}

\subfile{sections/title}

\pagenumbering{roman}
\setcounter{page}{0}

\begin{linenumbers}
\makeatletter
\patchcmd{\@startsection}{\@ifstar}{\nolinenumbers\@ifstar}{}{}
\patchcmd{\@xsect}{\ignorespaces}{\linenumbers\ignorespaces}{}{}
\makeatother

\section*{Declaration} \label{sec:declaration}
\addcontentsline{toc}{section}{Declaration}
\subfile{sections/declaration}
\newpage

\addcontentsline{toc}{section}{Abstract}
\section*{Abstract} \label{sec:abstract}
\subfile{sections/abstract}
\newpage

\addcontentsline{toc}{section}{Acknowledgment}
\section*{Acknowledgment} \label{sec:acknowledgement}
\subfile{sections/acknowledgment}
\newpage
\end{linenumbers}

\glsunsetall

\nolinenumbers

\tableofcontents
\newpage

\addcontentsline{toc}{section}{\listfigurename}
\listoffigures
\newpage

\addcontentsline{toc}{section}{\listtablename}
\listoftables
\newpage

\pagenumbering{arabic}

\glsresetall

\glsunset{ieee}
\glsunset{acm}
\glsunset{gps}
\glsunset{lidar}

\begin{linenumbers}
\makeatletter
\patchcmd{\@startsection}{\@ifstar}{\nolinenumbers\@ifstar}{}{}
\patchcmd{\@xsect}{\ignorespaces}{\linenumbers\ignorespaces}{}{}
\makeatother

\section{Introduction and Motivation} \label{sec:intro}
\subfile{sections/introduction}

\section{Background and Related Work} \label{sec:background}
\subfile{sections/background}

\section{Requirements Analysis} \label{sec:requirements}
\subfile{sections/requirements}

\section{Solution Design} \label{sec:design}
\subfile{sections/design}

\section{Implementation} \label{sec:implementation}
\subfile{sections/implementation}

\section{Testing} \label{sec:testing}
\subfile{sections/testing}

\section{Impact} \label{sec:impact}
\subfile{sections/impact}

\section{Conclusion} \label{sec:conclusion}
\subfile{sections/conclusion}

\section{Future Work} \label{sec:future}
\subfile{sections/future}

\section{Reflection} \label{sec:reflection}
\subfile{sections/reflection}

\end{linenumbers}

\newpage

\printbibliography[heading=bibintoc]

\newpage

\begin{appendices}
    \section{Project Plan} \label{sec:plan}
    \subfile{sections/plan}
\end{appendices}

\end{document}
